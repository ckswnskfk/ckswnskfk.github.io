---
title: "2023.10.26 til"
excerpt: "오늘 배운 모든 내용"
categories:
  - til
tags:
  - git
last_modified_at: 2023-10-26
toc: true
---

# git

## git으로 협업하기

### `git push` 이전에

협업을 하는 상황에서는 내가 마지막으로 pull을 받은 이후 또 다른 변경 사항이 리모트에 반영이 될 수 있다.  
그걸 다시 pull 받지 않은 상태에서 변경이 발생한 파일을 수정하고 push를 하려고 하면 push가 reject 되는데, 이것을 어떻게 해결할까?

`git pull`로 해결할 수 있다.  
이 때에는 merge conflict가 발생한다. 왜냐하면 pull은 리모트 레파지토리의 최신 커밋들을 로컬 레파지토리에 가져와서 merge를 하는 과정까지 포함하기 때문이다.

![푸쉬 이전에 풀을 해줘야 한다](/assets/images/git-pull-push1.png)

최종적으로 push가 된 리모트 레파지토리의 모습은 다음과 같다.

![풀을 하고 푸쉬를 한 최종 모습](/assets/images/git-pull-push2.png)
(이미지 출처: [코드잇 강의](https://www.codeit.kr/topics/git/lessons/2934))

`git pull`은 리모트의 내용을 로컬에 머지 해버리는데, 코드를 확인하고 싶을 수 있다.  
이 경우에 사용하는 명령어가 `git fetch` 이다. `fetch`는 리모트에서 내용을 가져오긴 하지만, 머지를 하지는 않는다.  
이제 가져온 리모트의 코드와 로컬의 코드를 비교하기 위해 `diff` 를 사용해 비교하면 된다.  
ex) `git diff 로컬브랜치 origin/리모트브랜치`  
여기서 origin은 사용자가 미리 정한 리모트 레파지토리의 이름으로 바꿔서 쓰면 된다. 일반적으로는 origin이니까 일단 썼다.  
로컬브랜치와 리모트브랜치도 대부분의 경우 이름이 같겠지만 지금은 구분을 위해 저렇게 썼다.

### 누가 이 코드를 작성하였는가?(궁예)

`git blame 파일명` 커맨드로 해당 파일의 코드가 줄 별로 어떤 커밋에 의해 지금의 모습이 되었는지 알 수 있다.  
그리고 `git show 커밋아이디` 를 통해 해당 코드가 누구에 의해 만들어졌는지 알 수 있다.

### 이미 리모트 레파지토리에 올라간 커밋을 취소해야 한다면?

그냥 해당 코드를 수정하고 커밋, 푸시 해도 된다. 하지만 그것을 한 번에 해주는 커맨드가 있다.  
`git revert 커밋아이디`  
revert는 되돌리다, 복귀하다라는 의미로 최신 커밋에서 한 작업을 되돌리고 다시 커밋까지 해준다.  
이 커맨드를 실행하면 revert한다는 기본 메시지가 써 있는 커밋 메세지 작성 화면이 뜬다. 이후 푸쉬까지 하면 리모트에도 해당 내용이 잘 반영 돼 있다.

그냥 이전 커밋으로 `reset` 하면 안될까 싶을 수도 있다. 하지만 로컬에서 `reset`을 한 후 푸쉬를 하면 head가 가리키는 커밋 이후의 커밋이 있기 때문에 해당 일단 `pull`을 한 후 푸쉬를 하라는 안내가 뜬다.

### 여러 커밋 취소하기

바로 이전 커밋이 아니라 더 예전의 커밋이나, 여러개의 커밋을 취소하려면 어떻게 할까?

`git revert 커밋아이디1..커밋아이디2`  
`revert` 커맨드에 두 개의 커밋 아이디를 `..`으로 이어서 아규먼트를 주면 되는데, 범위로 인식해 그 사이의 커밋들을 취소한다.  
주의할 점은 커밋아이디1의 커밋은 취소에 포함되지 않고 바로 다음 커밋부터 커밋아이디2까지 적용된다는 것이다. 그러면 해당 범위에 있는 커밋 메시지를 입력하는 화면이 범위에 포함된 커밋 갯수 만큼 뜬다.
