---
title: "[F-Lab 모각코 챌린지] 45일차"
excerpt: "five lines of code - 1"
categories:
  - Refactoring
tags:
  - f-lab
  - 에프랩
  - TIL
  - Typescript
  - Five lines of code
last_modified_at: 2023-07-03
toc: true
---

파이브 라인스 오브 코드라는 책으로 리팩토링을 공부하기로 했다. 타입스크립트는 사실 써본적이 없어서 유데미 강의를 병행해 들으려고 한다. 오늘은 책의 도입부가 되는 1장을 요약해보려 한다.

# 리팩터링 리팩터링하기

높은 품질의 코드를 얻는 가장 일반적인 방법은 리팩터링이다. 하지만 잘 알려진 코드 스멜과 단위 테스트를 가지고 리팩터링을 학습하는 건 진입 장벽이 너무 높다.

이 책은 테스트 및 추상적인 코드 스멜 없이 단순하게 리팩터링을 시작하는 방법을 설명한다.

## 리팩터링이란 무엇인가?

단순하게 말하자면 '기능을 변경하지 않고 코드를 변경하는 것'이다. 리팩터링을 해야하는 이유는 무엇인가?

- 코드를 더 빠르게 동작하게 하기 위해
- 더 작은 코드를 만들기 위해
- 코드를 재사용 가능하게 하기 위해
- 코드의 가독성을 높이고 유지보수를 용이하게 하기 위해 -> 핵심

```javascript
// 변경 전
return pow(base, exp / 2) * pow(base, exp / 2);

// 변경 후
let result = pow(base, exp / 2);
return result * result;
```

위에서 소개한 마지막 이유가 가장 중요하다. 우리는 대개 좋은 코드를 이렇게 정의한다.

> 사람이 읽기 쉽고, 유지보수가 용이하며, 의도한 대로 동작하는 코드.

이 책에서는 좋은 코드를 만들기 위한 리팩터링만을 고려한다. 그래서 리팩터링을 다음과 같이 정의한다.

> 기능을 변경하지 않고 코드의 가독성과 유지보수가 쉽도록 코드를 변경하는 것.

또한 이 책에서 얘기할 리팩터링 유형은 객체지향 프로그래밍에 기반을 둔다.

리팩터링의 궁극적 목표는 경제성이다. 코드의 가독성을 높이면 비싼 프로그래머의 시간을 새로운 기능을 구현하는 데 더 할애할 수 있다. 유지보수가 용이해지면 버그가 줄어들고 수정이 쉬워진다. 좋은 코드베이스는 생각하기 편하다.

## 무엇을 리팩터링할 것인가?

이것이 첫 번째 난관이다. 보통 리팩터링과 함께 이야기하는 코드 스멜은 추상적이다.

이 책은 그 대신 쉽게 인식하고 적용할 수 있는 규칙을 제시한다.

### 코드 스멜의 예

대표적인 코드 스멜은 '함수는 한 가지 작업을 수행해야 한다.' 이다. 여기서 한 가지의 의미를 생각보다 포괄적이다.

### 규칙의 예

'다섯 줄 제한' 이라는 규칙은 명확하고 간결하다.

제시할 규칙들이 모든 상황에서 좋은 코드를 보장할 순 없다. 그러나 어디서 시작해야 할지 모르는 경우에 유용한 리팩터링 가이드가 된다.

## 리팩터링은 언제 할까?

리팩터링은 정기적으로 수행하는 것이 효과적이고 비용이 적게 들기에 가능하면 일상 업무에 통합하는 것이 좋다. 이 책에서는 테스트와 리팩터링을 분리해 리팩터링에 초점을 맞출 것이다.

규칙 기반의 리팩터링을 수행하기 때문에 작업 절차가 간단하다.

메서드 선택 -> 메서드가 규칙을 위반했는가? -> 규칙에 해당하는 리팩터링 패턴 찾기 -> 지시에 따르기 -> 모든 컴파일 오류 수정하기 -> 메서드가 규칙을 위반했는가?

### 레거시 시스템에서의 리팩터링

대규모 레거시 시스템에서 전체를 먼저 리팩터링할 필요는 없다. 새로운 것을 구현할 때마다 새 코드를 쉽게 추가할 수 있게 리팩터링을 먼저 한다.

### 언제 리팩터링을 하지 말아야 할까?

리팩터링이 필요하지 않은 경우가 세 가지 있다.

- 한 번 실행하고 삭제할 코드
- 폐기되기 전 유지보수 모드에 있는 코드
- 임베디드 시스템 등 엄격한 성능 요구사항이 있는 코드

그 외의 모든 경우에 리팩터링을 하는 것이 좋다.

## (안전한) 리팩터링 방법

다음과 같은 도구면 충분하다.

- 상세하고 단계별로 구조화된 리팩터링 패턴
- 버전 관리
- 컴파일러

이 책에서는 컴파일러와 타입을 사용해 대부분의 실수를 잡아낼 것이다. 혹시 모르니 버전 관리도 필요하다.

## 핵심 예제: 2D 퍼즐 게임

이 책의 1부에서는 하나의 코드베이스를 사용한다. 이 코드는 이미 DRY, KISS 원칙을 준수하지만 완전하지는 않다.

컴퓨터 게임을 예제로 한 이유는 어떤 동작이 잘못되었는지 쉽게 발견할 수 있기 때문이다.

### 두 번째 코드 베이스

한 편 연습을 위해 난이도가 높고 답이 없는 프로젝트를 하나 더 제공한다.

## 실제 환경에서 소프트웨어에 대한 주의 사항

이 책은 리팩터링에 대한 소개가 목적이다. 모든 프로덕션 코드에 적용할 수 있는 특별한 규칙을 제공하는 것은 아니다.

규칙에 대해 학습할 때 다음과 같은 순서를 따른다. 먼저 그 이름을 익히고 그대로 따라한다. 여기에 익숙해지면 예외를 포함한 설명을 학습한다. 마지막으로 이 설명을 사용해 코드 스멜에 대한 기본적인 이해를 쌓는다.

규칙의 목적은 이해를 쌓는 것이다.
