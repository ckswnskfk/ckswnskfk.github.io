---
title: "[F-Lab 모각코 챌린지] 31일차"
excerpt: "OAuth"
categories:
  - Javascript
tags:
  - f-lab
  - 에프랩
  - TIL
  - Javascript
  - OAuth
last_modified_at: 2023-06-19
toc: true
---

최근에는 어디서든 구글로 로그인하기, 네이버로 로그인 하기, 카카오로 로그인 하기 등 플랫폼 계정으로 회원가입 및 로그인을 하는 기능을 많이 볼 수 있다. 이것이 바로 OAuth(Open Authorization) 프로토콜을 사용한 예로, OAuth는 인터넷 사용자들이 비밀번호를 제공하지 않고 다른 웹사이트 상의 자신들의 정보에 대해 웹사이트나 애플리케이션의 접근 권한을 부여할 수 있는 공통적인 수단으로서 사용되는, <u>접근 위임</u>을 위한 개방형 표준이다.

# 탄생 배경

과거에는 사용자가 다른 애플리케이션에 접근하기 위해서는 당연하게도 해당 애플리케이션에 직접 로그인해야 했다. 이는 사용자가 매번 계정 정보를 입력하고 관리해야 하는 불편함은 물론, 해당 애플리케이션이 사용자의 계정 정보를 보관해야 했기 때문에 보안 취약점이 발생할 수 있었다.

OAuth는 이전에 구글은 AuthSub, 야후는 BBAuth 등 각자 회사가 개발한 방법을 사용하였지만 표준화 되지 않아 각각의 방법에 맞춰 개발 및 유지 보수를 해야했다.

이러한 문제를 해결하기 위해 OAuth가 개발되었다. OAuth는 사용자가 자신의 계정 정보를 안전하게 보호하면서도 다른 애플리케이션에 접근할 수 있는 방법을 제공한다.

# OAuth 2.0

참고로 1.0 버전은 2006년 트위터와 Ma.gnolia 가 주도적으로 개발하였다. 하지만 OAuth 1.0은 구현이 복잡하고 웹 이외의 환경에서 지원이 부족했으며, HMAC을 통해 암호화를 하는 번거로운 과정도 있었다. 또한 인증토큰(access token)이 만료되지 않았다.

이에 OAuth 2.0은 앞선 여러 문제들을 해결하고자 처음부터 표준으로 만들어졌는데, 기능을 단순화 하고, 기능과 규모의 확장성 등을 지원할 수 있게 만들어졌다. OAuth 1.0과는 다음과 같은 차이점이 있다.

1. https가 필수가 되어서 오히려 구현이 간단해짐.
2. 암호화는 https에 맡김.
3. 1.0a는 인증방식이 한 가지였지만 2는 다양한 인증방식을 지원.
4. api서버에서 인증서버를 분리 할 수 있도록 설계.

# 주요 용어

|      용어      |                                                            설명                                                             |
| :------------: | :-------------------------------------------------------------------------------------------------------------------------: |
| Authentication |                                           인증, 접근 자격이 있는지 검증하는 단계                                            |
| Authorization  |    인가, 자원에 접근할 권한을 부여하는 것. 인가가 완료되면 리소스 접근 권한이 담긴 Access Token이 클라이언트에게 부여됨.    |
|  Access Token  |                 리소스 서버에게서 리소스 소유자의 보호된 자원을 획득할 때 사용되는 만료 기간이 있는 Token.                  |
| Refresh Token  | Access Token 만료시 이를 갱신하기 위한 용도로 사용하는 Token. Refresh Token은 일반적으로 Access Token보다 만료 기간이 길다. |

# Roles(역할)

|         역할         |                                                             설명                                                              |
| :------------------: | :---------------------------------------------------------------------------------------------------------------------------: |
|    Resource Owner    |                                                    리소스 주인. 즉 사용자                                                     |
|        Client        |                           보호된 자원을 사용하려고 Resoure Server에 접근 요청을 하는 애플리케이션.                            |
|   Resource Server    |   사용자의 보호된 자원을 호스팅하는 서버.(로그인, 회원 가입의 경우 개인정보라는 리소스를 관리하는 구글, 카카오, 네이버 등)    |
| Authorization Server | 권한 서버. 인증/인가를 수행하는 서버로 클라이언트의 접근 자격을 확인하고 Access Token을 발급하여 권한을 부여하는 역할을 수행. |

# 인증 방식

간단한 인증 방식 순서는 다음과 같다.

1. 클라이언트 등록: 먼저 클라이언트 애플리케이션(요청하는 애플리케이션)이 서비스 제공자에게 등록되어야 한다. 등록을 통해 클라이언트에게 고유한 식별자(Client ID)와 비밀 키(Client Secret)가 제공된다.

2. 사용자 리다이렉션: 클라이언트 애플리케이션은 사용자를 서비스 제공자의 인증 페이지로 리다이렉션한다. 이때, 클라이언트는 인증 요청에 대한 정보를 함께 전달한다. 예를 들어, 클라이언트 ID, 요청한 스코프(액세스할 리소스의 범위), 리디렉션 URL 등이 전달된다.

3. 사용자 인증: 사용자는 서비스 제공자의 인증 페이지에서 자신의 계정 정보를 입력하여 인증한다. 이때, 사용자는 서비스 제공자에게 자신의 계정 정보를 제공하게 되는데, 이 정보는 클라이언트 애플리케이션과 공유되지 않는다.

4. 권한 부여 동의: 사용자가 인증에 성공하면, 서비스 제공자는 클라이언트 애플리케이션에 대한 사용자의 권한 부여 동의를 요청한다. 이때, 클라이언트가 요청한 스코프에 따라 사용자가 허용한 범위 내에서 권한이 부여된다.

5. 액세스 토큰 발급: 사용자가 권한 부여를 승인하면, 서비스 제공자는 클라이언트에게 액세스 토큰(Access Token)을 발급한다. 액세스 토큰은 클라이언트가 사용자의 권한으로 리소스에 접근할 수 있는 인증 정보이다.

6. 리소스 접근: 클라이언트 애플리케이션은 발급받은 액세스 토큰을 사용하여 서비스 제공자의 API를 호출하고, 사용자의 리소스에 접근한다. 이때, 액세스 토큰을 API 호출의 인증 수단으로 사용한다.

\*참고: <https://ko.wikipedia.org/wiki/OAuth>,  
<https://hudi.blog/oauth-2.0/>,  
<https://showerbugs.github.io/2017-11-16/OAuth-%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C>,  
<https://blog.naver.com/mds_datasecurity/222182943542>,  
<https://chat.openai.com/>
