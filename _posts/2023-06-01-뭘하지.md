---
title: "[F-Lab 모각코 챌린지] 13일차"
excerpt: "Jest로 테스트 코드 작성해보기"
categories:
  - Programing
tags:
  - f-lab
  - 에프랩
  - TIL
  - Test
  - Jest
last_modified_at: 2023-06-01
toc: true
---

멘토님께서 코드 리뷰 해 주실 때, 테스트 도구 사용해 본 적 있냐고 여쭤보셨다. 난 언제나처럼 아니요...^^ 말씀하시는 투를 들어보니 요샌 기본인 것 같다. 프로젝트에도 분명 써야 할 것 같다. 그러니까 오늘은 우선 기본적인 사용법 부터 알아보자.

# Jest?

먼저 jest란 무엇인지 대충 알아보고 들어가자. jest 공식 문서에 들어가면 대문짝만하게 써 있다.

> Jest is a delightful JavaScript Testing Framework with a focus on simplicity.

번역해 보니 'jest는 단순성에 중점을 둔 유쾌한 JavaScript 테스트 프레임워크입니다.' 그래, 유쾌한 녀석.. 여러 라이브러리, 프레임워크와 호환 된댄다. 별 다른 설정 없이 자체 프로세스를 사용하여 병렬적으로 실행되며, 훌륭한 api를 제공한다고 한다. 말하자면 간편하게 사용할 수 있는 강력한 테스트 도구란거겠지.

# 시작하기

바로 시작해보자. 참고로 npm이 먼저 설치돼 있어야 한다.
만일 새 폴더를 만들어 진행한다면 package.json 파일이 없을 것이기 때문에 아래 명령어를 먼저 실행하자.

`npm init -y`

init은 package.json 파일을 만들어준다. -y 옵션을 사용하면 최초 설치 옵션을 건너뛴다.

이제 jest를 설치하자.

`npm install --save-dev jest`

--save-dev은 패키지 설치 후 devDependencies에 추가하는 옵션이다. 이곳에 추가된 항목들은 개발 단계에서만 사용하는 패키지들이다.

설치가 다 됐다면 package.json 파일을 살펴보자. devDependencies에 jest가 설치돼 있는 걸 볼 수 있을 것이다. 여기서 "scripts"의 "test"의 값을 "jest"로 바꿔야 사용할 수 있다.

```json
{
  "name": "first-jest",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "jest"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "jest": "^29.5.0"
  }
}
```

아무 것도 없는 폴더에서 만들었을 경우의 package.json 파일이다.

이어서 테스트 할 파일을 작성해야 하는데, 공식 문서의 시작 가이드는 아래와 같다.

```javascript
function sum(a, b) {
  return a + b;
}
module.exports = sum;
```

```javascript
const sum = require("./sum");

test("adds 1 + 2 to equal 3", () => {
  expect(sum(1, 2)).toBe(3);
});
```

ES6의 ES 모듈이 아니라 CommonJS의 모듈이다. 일단 내 맘대로 ES 모듈로 썼더니 오류가 난다.. jest에서 ES 모듈은 지원하지 않는 것 같다. 공식 문서를 보니 실험적으로 지원하는데, 그 방법이 지금 시도하기엔 어려워 보여 다른 방법을 찾았다. 바벨을 써서 트랜스파일링 해야한댄다. 필요한 의존성 주입을 위해 `npm install -D jest @types/jest @babel/core @babel/preset-env` 명령어를 실행하고, 바벨 설정 파일과 jest 설정 파일을 만든다.

babel.config.json

```json
{
  "presets": ["@babel/preset-env"]
}
```

jest.config.json

```json
{
  "verbose": true,
  "collectCoverage": true
}
```

이제 다음과 같이 ES 모듈을 사용해도 오류가 나지 않고 테스트가 성공적으로 실행된다!

sum.js

```javascript
const sum = (a, b) => {
  return a + b;
};
export default sum;
```

sum.test.js

```javascript
import sum from "./sum";

test("1 더하기 2는 3이니?", () => {
  expect(sum(1, 2)).toBe(3);
});
```

\*출처: [jest 공식 문서](https://jestjs.io/),
<https://docs.npmjs.com/>
<https://jae04099.tistory.com/entry/Node-npm-install-save-save-dev-%EC%B0%A8%EC%9D%B4>,
<https://mine-it-record.tistory.com/633>,
<https://velog.io/@dacircle/JEST-import-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0>,
<https://poiemaweb.com/jest-esm>
